services:
  sysmon:
    image: peterpage2115/sysmon:latest
    container_name: sysmon
    # pid: host allows psutil to see host CPU/RAM, not just container stats
    pid: host
    ports:
      - "8001:8000"  # FastAPI serves both API and static Svelte frontend
    labels:
      - "net.unraid.docker.webui=http://[IP]:[PORT:8000]"
      - "net.unraid.docker.icon=https://raw.githubusercontent.com/PeterPage2115/SysMon/main/icon.png"
    volumes:
      # Docker SDK access for monitoring containers
      - /var/run/docker.sock:/var/run/docker.sock:ro
      # SQLite database persistence (Tamagotchi state: name, level, XP)
      - ./data:/app/data
      # Host disk monitoring - mount host path to check disk usage
      # For Unraid: /mnt/user is the main array
      - /mnt/user:/host/mnt/user:ro
    environment:
      - PYTHONUNBUFFERED=1
      - DATABASE_URL=sqlite:///./data/sysmon.db
      # Path to check for disk usage (inside container)
      - DISK_PATH=/host/mnt/user
    restart: unless-stopped
    networks:
      - sysmon-network

networks:
  sysmon-network:
    driver: bridge